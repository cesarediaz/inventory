<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html 
     PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
     "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
  <title>Module: ReportSystem</title>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <meta http-equiv="Content-Script-Type" content="text/javascript" />
  <link rel="stylesheet" href=".././rdoc-style.css" type="text/css" media="screen" />
  <script type="text/javascript">
  // <![CDATA[

  function popupCode( url ) {
    window.open(url, "Code", "resizable=yes,scrollbars=yes,toolbar=no,status=no,height=150,width=400")
  }

  function toggleCode( id ) {
    if ( document.getElementById )
      elem = document.getElementById( id );
    else if ( document.all )
      elem = eval( "document.all." + id );
    else
      return false;

    elemStyle = elem.style;
    
    if ( elemStyle.display != "block" ) {
      elemStyle.display = "block"
    } else {
      elemStyle.display = "none"
    }

    return true;
  }
  
  // Make codeblocks hidden by default
  document.writeln( "<style type=\"text/css\">div.method-source-code { display: none }</style>" )
  
  // ]]>
  </script>

</head>
<body>



    <div id="classHeader">
        <table class="header-table">
        <tr class="top-aligned-row">
          <td><strong>Module</strong></td>
          <td class="class-name-in-header">ReportSystem</td>
        </tr>
        <tr class="top-aligned-row">
            <td><strong>In:</strong></td>
            <td>
                <a href="../files/lib/report_system_rb.html">
                lib/report_system.rb
                </a>
        <br />
            </td>
        </tr>

        </table>
    </div>
  <!-- banner header -->

  <div id="bodyContent">



  <div id="contextContent">

    <div id="description">
      <p>
This file is part of Hardware Inventory.
</p>
<pre>
    Copyright (C) 2009 Cesar Diaz

    Hardware Inventory is free software: you can redistribute it and/or modify
    it under the terms of the GNU General Public License as published by
    the Free Software Foundation, either version 3 of the License, or
    any later version.

    This program is distributed in the hope that it will be useful,
    but WITHOUT ANY WARRANTY; without even the implied warranty of
    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the
    GNU General Public License for more details.

    You should have received a copy of the GNU General Public License
    along with this program. If not, see &lt;http://www.gnu.org/licenses/&gt;.
</pre>

    </div>


   </div>

    <div id="method-list">
      <h3 class="section-bar">Methods</h3>

      <div class="name-list">
      <a href="#M000202">bills_report</a>&nbsp;&nbsp;
      <a href="#M000199">computers_report</a>&nbsp;&nbsp;
      <a href="#M000200">generic_report</a>&nbsp;&nbsp;
      <a href="#M000197">get_elements</a>&nbsp;&nbsp;
      <a href="#M000196">get_heads</a>&nbsp;&nbsp;
      <a href="#M000198">make_a_report_of</a>&nbsp;&nbsp;
      <a href="#M000201">places_report</a>&nbsp;&nbsp;
      <a href="#M000203">workstations_report</a>&nbsp;&nbsp;
      <a href="#M000195">xls_report</a>&nbsp;&nbsp;
      <a href="#M000194">xls_report_complete_for_a_place</a>&nbsp;&nbsp;
      <a href="#M000193">xls_report_workstations</a>&nbsp;&nbsp;
      </div>
    </div>

  </div>


    <!-- if includes -->

    <div id="section">





      


    <!-- if method_list -->
    <div id="methods">
      <h3 class="section-bar">Protected Instance methods</h3>

      <div id="method-M000202" class="method-detail">
        <a name="M000202"></a>

        <div class="method-heading">
          <a href="#M000202" class="method-signature">
          <span class="method-name">bills_report</span><span class="method-args">(page, elements)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
This method fill the the places report
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000202-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000202-source">
<pre>
     <span class="ruby-comment cmt"># File lib/report_system.rb, line 252</span>
252:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">bills_report</span>(<span class="ruby-identifier">page</span>, <span class="ruby-identifier">elements</span>)
253:     <span class="ruby-identifier">row</span> = <span class="ruby-value">1</span>
254:      <span class="ruby-keyword kw">for</span> <span class="ruby-identifier">object</span> <span class="ruby-keyword kw">in</span> <span class="ruby-identifier">elements</span>
255:        <span class="ruby-identifier">page</span>.<span class="ruby-identifier">write</span>(<span class="ruby-identifier">row</span>,<span class="ruby-value">0</span>,<span class="ruby-identifier">object</span>.<span class="ruby-identifier">code</span>)
256:        <span class="ruby-identifier">page</span>.<span class="ruby-identifier">write</span>(<span class="ruby-identifier">row</span>,<span class="ruby-value">1</span>,<span class="ruby-identifier">object</span>.<span class="ruby-identifier">company</span>.<span class="ruby-identifier">name</span>)
257:        <span class="ruby-identifier">page</span>.<span class="ruby-identifier">write</span>(<span class="ruby-identifier">row</span>,<span class="ruby-value">2</span>,<span class="ruby-identifier">object</span>.<span class="ruby-identifier">date</span>.<span class="ruby-identifier">strftime</span>(<span class="ruby-value str">&quot;%d/%m/%Y&quot;</span>))
258:        <span class="ruby-identifier">row</span> <span class="ruby-operator">+=</span> <span class="ruby-value">1</span>
259:      <span class="ruby-keyword kw">end</span>
260:   <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000199" class="method-detail">
        <a name="M000199"></a>

        <div class="method-heading">
          <a href="#M000199" class="method-signature">
          <span class="method-name">computers_report</span><span class="method-args">(page, elements, row)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
This method fill the the computers report
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000199-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000199-source">
<pre>
     <span class="ruby-comment cmt"># File lib/report_system.rb, line 187</span>
187:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">computers_report</span>(<span class="ruby-identifier">page</span>, <span class="ruby-identifier">elements</span>, <span class="ruby-identifier">row</span>)
188:     <span class="ruby-identifier">row</span>.<span class="ruby-identifier">nil?</span> <span class="ruby-value">? </span><span class="ruby-identifier">row</span> = <span class="ruby-value">1</span> <span class="ruby-operator">:</span> <span class="ruby-identifier">row</span> = <span class="ruby-identifier">row</span>
189:      <span class="ruby-keyword kw">for</span> <span class="ruby-identifier">object</span> <span class="ruby-keyword kw">in</span> <span class="ruby-identifier">elements</span>
190:        <span class="ruby-ivar">@disks</span> = <span class="ruby-value str">''</span>
191:        <span class="ruby-identifier">object</span>.<span class="ruby-identifier">harddisk</span>.<span class="ruby-identifier">empty?</span> <span class="ruby-value">? </span><span class="ruby-identifier">t</span>(<span class="ruby-value str">'phrases.n'</span>) <span class="ruby-operator">:</span> <span class="ruby-identifier">object</span>.<span class="ruby-identifier">harddisk</span>.<span class="ruby-identifier">collect</span> {<span class="ruby-operator">|</span><span class="ruby-identifier">x</span><span class="ruby-operator">|</span>
192:        <span class="ruby-ivar">@disks</span> = <span class="ruby-ivar">@disks</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">x</span>.<span class="ruby-identifier">description_model</span> <span class="ruby-operator">+</span> <span class="ruby-value str">&quot; - &quot;</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">x</span>.<span class="ruby-identifier">size</span>.<span class="ruby-identifier">to_s</span> <span class="ruby-operator">+</span> <span class="ruby-value str">&quot; &quot;</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">x</span>.<span class="ruby-identifier">unit</span>} <span class="ruby-keyword kw">rescue</span> <span class="ruby-keyword kw">nil</span>
193:        <span class="ruby-ivar">@memories</span> = <span class="ruby-value str">''</span>
194:        <span class="ruby-identifier">object</span>.<span class="ruby-identifier">memory</span>.<span class="ruby-identifier">empty?</span> <span class="ruby-value">? </span><span class="ruby-identifier">t</span>(<span class="ruby-value str">'phrases.n'</span>) <span class="ruby-operator">:</span> <span class="ruby-identifier">object</span>.<span class="ruby-identifier">memory</span>.<span class="ruby-identifier">collect</span> {<span class="ruby-operator">|</span><span class="ruby-identifier">x</span><span class="ruby-operator">|</span>
195:        <span class="ruby-ivar">@memories</span> = <span class="ruby-ivar">@memories</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">x</span>.<span class="ruby-identifier">description_model</span> <span class="ruby-operator">+</span> <span class="ruby-value str">&quot; - &quot;</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">x</span>.<span class="ruby-identifier">size</span>.<span class="ruby-identifier">to_s</span> <span class="ruby-operator">+</span> <span class="ruby-value str">&quot; &quot;</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">x</span>.<span class="ruby-identifier">unit</span>} <span class="ruby-keyword kw">rescue</span> <span class="ruby-keyword kw">nil</span>
196:        <span class="ruby-ivar">@cds</span> = <span class="ruby-value str">''</span>
197:        <span class="ruby-identifier">object</span>.<span class="ruby-identifier">cd</span>.<span class="ruby-identifier">empty?</span> <span class="ruby-value">? </span><span class="ruby-identifier">t</span>(<span class="ruby-value str">'phrases.n'</span>) <span class="ruby-operator">:</span> <span class="ruby-identifier">object</span>.<span class="ruby-identifier">cd</span>.<span class="ruby-identifier">collect</span> {<span class="ruby-operator">|</span><span class="ruby-identifier">x</span><span class="ruby-operator">|</span>
198:        <span class="ruby-ivar">@cds</span> = <span class="ruby-ivar">@cds</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">x</span>.<span class="ruby-identifier">description_model</span> <span class="ruby-operator">+</span> <span class="ruby-value str">&quot; &quot;</span>} <span class="ruby-keyword kw">rescue</span> <span class="ruby-keyword kw">nil</span>
199:        <span class="ruby-ivar">@dvds</span> = <span class="ruby-value str">''</span>
200:        <span class="ruby-identifier">object</span>.<span class="ruby-identifier">dvd</span>.<span class="ruby-identifier">empty?</span> <span class="ruby-value">? </span><span class="ruby-identifier">t</span>(<span class="ruby-value str">'phrases.n'</span>) <span class="ruby-operator">:</span> <span class="ruby-identifier">object</span>.<span class="ruby-identifier">dvd</span>.<span class="ruby-identifier">collect</span> {<span class="ruby-operator">|</span><span class="ruby-identifier">x</span><span class="ruby-operator">|</span>
201:        <span class="ruby-ivar">@dvds</span> = <span class="ruby-ivar">@dvds</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">x</span>.<span class="ruby-identifier">description_model</span> <span class="ruby-operator">+</span> <span class="ruby-value str">&quot; &quot;</span>} <span class="ruby-keyword kw">rescue</span> <span class="ruby-keyword kw">nil</span>
202: 
203:        <span class="ruby-identifier">page</span>.<span class="ruby-identifier">write</span>(<span class="ruby-identifier">row</span>,<span class="ruby-value">0</span>,<span class="ruby-identifier">object</span>.<span class="ruby-identifier">name</span>)
204:        <span class="ruby-identifier">page</span>.<span class="ruby-identifier">write</span>(<span class="ruby-identifier">row</span>,<span class="ruby-value">1</span>,<span class="ruby-identifier">object</span>.<span class="ruby-identifier">mac</span>)
205:        <span class="ruby-identifier">page</span>.<span class="ruby-identifier">write</span>(<span class="ruby-identifier">row</span>,<span class="ruby-value">2</span>,<span class="ruby-identifier">object</span>.<span class="ruby-identifier">ip</span>)
206:        <span class="ruby-identifier">page</span>.<span class="ruby-identifier">write</span>(<span class="ruby-identifier">row</span>,<span class="ruby-value">3</span>,<span class="ruby-identifier">object</span>.<span class="ruby-identifier">available</span> <span class="ruby-operator">==</span> <span class="ruby-keyword kw">true</span> <span class="ruby-operator">?</span> <span class="ruby-identifier">t</span>(<span class="ruby-value str">'phrases.y'</span>) <span class="ruby-operator">:</span> <span class="ruby-identifier">t</span>(<span class="ruby-value str">'phrases.n'</span>))
207:        <span class="ruby-identifier">page</span>.<span class="ruby-identifier">write</span>(<span class="ruby-identifier">row</span>,<span class="ruby-value">4</span>,<span class="ruby-identifier">object</span>.<span class="ruby-identifier">mother_board</span>.<span class="ruby-identifier">model_id</span>.<span class="ruby-identifier">nil?</span> <span class="ruby-value">? </span><span class="ruby-identifier">t</span>(<span class="ruby-value str">'phrases.n'</span>) <span class="ruby-operator">:</span>
208:                   <span class="ruby-identifier">object</span>.<span class="ruby-identifier">mother_board</span>.<span class="ruby-identifier">description_model</span>) <span class="ruby-keyword kw">rescue</span> <span class="ruby-keyword kw">nil</span>
209:        <span class="ruby-identifier">page</span>.<span class="ruby-identifier">write</span>(<span class="ruby-identifier">row</span>,<span class="ruby-value">5</span>,<span class="ruby-ivar">@disks</span>)
210:        <span class="ruby-identifier">page</span>.<span class="ruby-identifier">write</span>(<span class="ruby-identifier">row</span>,<span class="ruby-value">6</span>,<span class="ruby-ivar">@memories</span>)
211:        <span class="ruby-identifier">page</span>.<span class="ruby-identifier">write</span>(<span class="ruby-identifier">row</span>,<span class="ruby-value">7</span>,<span class="ruby-ivar">@cds</span>)
212:        <span class="ruby-identifier">page</span>.<span class="ruby-identifier">write</span>(<span class="ruby-identifier">row</span>,<span class="ruby-value">8</span>,<span class="ruby-ivar">@dvds</span>)
213:        <span class="ruby-identifier">page</span>.<span class="ruby-identifier">write</span>(<span class="ruby-identifier">row</span>,<span class="ruby-value">9</span>,<span class="ruby-identifier">object</span>.<span class="ruby-identifier">inventory_register</span>) <span class="ruby-keyword kw">rescue</span> <span class="ruby-keyword kw">nil</span>
214:        <span class="ruby-identifier">row</span> <span class="ruby-operator">+=</span> <span class="ruby-value">1</span>
215:      <span class="ruby-keyword kw">end</span>
216:   <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000200" class="method-detail">
        <a name="M000200"></a>

        <div class="method-heading">
          <a href="#M000200" class="method-signature">
          <span class="method-name">generic_report</span><span class="method-args">(page, elements, row, with_place)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
This method fill the a generic report that can be screens or printers
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000200-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000200-source">
<pre>
     <span class="ruby-comment cmt"># File lib/report_system.rb, line 221</span>
221:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">generic_report</span>(<span class="ruby-identifier">page</span>, <span class="ruby-identifier">elements</span>, <span class="ruby-identifier">row</span>, <span class="ruby-identifier">with_place</span>)
222:     <span class="ruby-identifier">row</span>.<span class="ruby-identifier">nil?</span> <span class="ruby-value">? </span><span class="ruby-identifier">row</span> = <span class="ruby-value">1</span> <span class="ruby-operator">:</span> <span class="ruby-identifier">row</span> = <span class="ruby-identifier">row</span>
223:      <span class="ruby-keyword kw">for</span> <span class="ruby-identifier">object</span> <span class="ruby-keyword kw">in</span> <span class="ruby-identifier">elements</span>
224:        <span class="ruby-keyword kw">if</span> <span class="ruby-keyword kw">not</span> <span class="ruby-identifier">object</span>.<span class="ruby-identifier">model_id</span>.<span class="ruby-identifier">nil?</span>
225:          <span class="ruby-identifier">page</span>.<span class="ruby-identifier">write</span>(<span class="ruby-identifier">row</span>,<span class="ruby-value">0</span>,<span class="ruby-identifier">object</span>.<span class="ruby-identifier">description_model</span>)
226:        <span class="ruby-keyword kw">else</span>
227:          <span class="ruby-identifier">page</span>.<span class="ruby-identifier">write</span>(<span class="ruby-identifier">row</span>,<span class="ruby-value">0</span>, <span class="ruby-value str">''</span>)
228:        <span class="ruby-keyword kw">end</span>
229:        <span class="ruby-identifier">page</span>.<span class="ruby-identifier">write</span>(<span class="ruby-identifier">row</span>,<span class="ruby-value">1</span>,<span class="ruby-identifier">object</span>.<span class="ruby-identifier">serialnumber</span>)
230:        <span class="ruby-identifier">page</span>.<span class="ruby-identifier">write</span>(<span class="ruby-identifier">row</span>,<span class="ruby-value">2</span>,<span class="ruby-identifier">object</span>.<span class="ruby-identifier">place</span>.<span class="ruby-identifier">title</span>)
231:        <span class="ruby-identifier">page</span>.<span class="ruby-identifier">write</span>(<span class="ruby-identifier">row</span>,<span class="ruby-value">3</span>,<span class="ruby-identifier">object</span>.<span class="ruby-identifier">inventory_register</span>) <span class="ruby-keyword kw">rescue</span> <span class="ruby-keyword kw">nil</span>
232:        <span class="ruby-identifier">row</span> <span class="ruby-operator">+=</span> <span class="ruby-value">1</span>
233:      <span class="ruby-keyword kw">end</span>
234:   <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000197" class="method-detail">
        <a name="M000197"></a>

        <div class="method-heading">
          <a href="#M000197" class="method-signature">
          <span class="method-name">get_elements</span><span class="method-args">(elements, model, method, param_id)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
This method get an array of elements depending of the parameters
</p>
<p>
Parameters:
</p>
<pre>
 elements: name that will be provide to the array when we get records
 model: model of data to get
 method: is the name of method to implement in the rescue of records
 param_id: parameter to provide the place from we need get records
</pre>
<p>
Return an array of elements
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000197-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000197-source">
<pre>
     <span class="ruby-comment cmt"># File lib/report_system.rb, line 146</span>
146:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">get_elements</span>(<span class="ruby-identifier">elements</span>, <span class="ruby-identifier">model</span>, <span class="ruby-identifier">method</span>, <span class="ruby-identifier">param_id</span>)
147:     <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">param_id</span>.<span class="ruby-identifier">empty?</span>
148:       <span class="ruby-identifier">eval</span> <span class="ruby-node">%&quot;
149:            @#{elements} = #{model}.#{method}
150:       &quot;</span>;
151:     <span class="ruby-keyword kw">else</span>
152:       <span class="ruby-identifier">eval</span> <span class="ruby-node">%&quot;
153:            @#{elements} = #{model}.#{method}#{param_id}
154:       &quot;</span>;
155:     <span class="ruby-keyword kw">end</span>
156:   <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000196" class="method-detail">
        <a name="M000196"></a>

        <div class="method-heading">
          <a href="#M000196" class="method-signature">
          <span class="method-name">get_heads</span><span class="method-args">(page, heads)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
This method take the parameters and write in the page of a xls file the
heads(first line in each column)
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000196-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000196-source">
<pre>
     <span class="ruby-comment cmt"># File lib/report_system.rb, line 124</span>
124:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">get_heads</span>(<span class="ruby-identifier">page</span>, <span class="ruby-identifier">heads</span>)
125:     <span class="ruby-identifier">eval</span> <span class="ruby-node">%&quot;
126: 
127:     @heads = #{heads}
128:      column = 0
129:      @heads.each do |cab|
130:       page.write(0,column,cab)
131:       column += 1
132:      end
133: 
134:     &quot;</span>;
135:   <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000198" class="method-detail">
        <a name="M000198"></a>

        <div class="method-heading">
          <a href="#M000198" class="method-signature">
          <span class="method-name">make_a_report_of</span><span class="method-args">(this, page, elements)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
This method call distinct methods of reports depending of the type
</p>
<pre>
 of report elements
</pre>
<p>
Parameters:
</p>
<pre>
 elements: name that will be provide to the array when we get records
 page: first row of each column
 elements: array with elements
</pre>
<p>
Return: nothing
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000198-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000198-source">
<pre>
     <span class="ruby-comment cmt"># File lib/report_system.rb, line 168</span>
168:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">make_a_report_of</span>(<span class="ruby-identifier">this</span>, <span class="ruby-identifier">page</span>, <span class="ruby-identifier">elements</span>)
169:     <span class="ruby-keyword kw">case</span> <span class="ruby-identifier">this</span>
170:     <span class="ruby-keyword kw">when</span> <span class="ruby-value str">'computers'</span>
171:       <span class="ruby-identifier">computers_report</span>(<span class="ruby-identifier">page</span>, <span class="ruby-identifier">elements</span>, <span class="ruby-keyword kw">nil</span>)
172:     <span class="ruby-keyword kw">when</span> <span class="ruby-value str">'screens'</span>
173:       <span class="ruby-identifier">generic_report</span>(<span class="ruby-identifier">page</span>, <span class="ruby-identifier">elements</span>, <span class="ruby-keyword kw">nil</span>, <span class="ruby-keyword kw">false</span>)
174:     <span class="ruby-keyword kw">when</span> <span class="ruby-value str">'printers'</span>
175:       <span class="ruby-identifier">generic_report</span>(<span class="ruby-identifier">page</span>, <span class="ruby-identifier">elements</span>, <span class="ruby-keyword kw">nil</span>, <span class="ruby-keyword kw">true</span>)
176:     <span class="ruby-keyword kw">when</span> <span class="ruby-value str">'workstations'</span>
177:       <span class="ruby-identifier">workstations_report</span>(<span class="ruby-identifier">page</span>, <span class="ruby-identifier">elements</span>, <span class="ruby-keyword kw">nil</span>, <span class="ruby-keyword kw">true</span>)
178:     <span class="ruby-keyword kw">when</span> <span class="ruby-value str">'places'</span>
179:       <span class="ruby-identifier">places_report</span>(<span class="ruby-identifier">page</span>, <span class="ruby-identifier">elements</span>)
180:     <span class="ruby-keyword kw">when</span> <span class="ruby-value str">'bills'</span>
181:       <span class="ruby-identifier">bills_report</span>(<span class="ruby-identifier">page</span>, <span class="ruby-identifier">elements</span>)
182:     <span class="ruby-keyword kw">end</span>
183:   <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000201" class="method-detail">
        <a name="M000201"></a>

        <div class="method-heading">
          <a href="#M000201" class="method-signature">
          <span class="method-name">places_report</span><span class="method-args">(page, elements)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
This method fill the the places report
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000201-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000201-source">
<pre>
     <span class="ruby-comment cmt"># File lib/report_system.rb, line 238</span>
238:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">places_report</span>(<span class="ruby-identifier">page</span>, <span class="ruby-identifier">elements</span>)
239:     <span class="ruby-identifier">row</span> = <span class="ruby-value">1</span>
240:      <span class="ruby-keyword kw">for</span> <span class="ruby-identifier">object</span> <span class="ruby-keyword kw">in</span> <span class="ruby-identifier">elements</span>
241:        <span class="ruby-identifier">page</span>.<span class="ruby-identifier">write</span>(<span class="ruby-identifier">row</span>,<span class="ruby-value">0</span>,<span class="ruby-identifier">object</span>.<span class="ruby-identifier">title</span>)
242:        <span class="ruby-identifier">page</span>.<span class="ruby-identifier">write</span>(<span class="ruby-identifier">row</span>,<span class="ruby-value">1</span>,<span class="ruby-identifier">object</span>.<span class="ruby-identifier">description</span>)
243:        <span class="ruby-identifier">page</span>.<span class="ruby-identifier">write</span>(<span class="ruby-identifier">row</span>,<span class="ruby-value">2</span>,<span class="ruby-identifier">object</span>.<span class="ruby-identifier">computer</span>.<span class="ruby-identifier">count</span>)
244:        <span class="ruby-identifier">page</span>.<span class="ruby-identifier">write</span>(<span class="ruby-identifier">row</span>,<span class="ruby-value">3</span>,<span class="ruby-identifier">object</span>.<span class="ruby-identifier">screen</span>.<span class="ruby-identifier">count</span>)
245:        <span class="ruby-identifier">page</span>.<span class="ruby-identifier">write</span>(<span class="ruby-identifier">row</span>,<span class="ruby-value">4</span>,<span class="ruby-identifier">object</span>.<span class="ruby-identifier">printer</span>.<span class="ruby-identifier">count</span>)
246:        <span class="ruby-identifier">page</span>.<span class="ruby-identifier">write</span>(<span class="ruby-identifier">row</span>,<span class="ruby-value">5</span>,<span class="ruby-constant">Workstation</span>.<span class="ruby-identifier">list_for_place</span>(<span class="ruby-identifier">object</span>.<span class="ruby-identifier">id</span>).<span class="ruby-identifier">count</span>.<span class="ruby-identifier">to_s</span>)
247:        <span class="ruby-identifier">row</span> <span class="ruby-operator">+=</span> <span class="ruby-value">1</span>
248:      <span class="ruby-keyword kw">end</span>
249:   <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000203" class="method-detail">
        <a name="M000203"></a>

        <div class="method-heading">
          <a href="#M000203" class="method-signature">
          <span class="method-name">workstations_report</span><span class="method-args">(page, elements)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
This method fill the the places report
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000203-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000203-source">
<pre>
     <span class="ruby-comment cmt"># File lib/report_system.rb, line 263</span>
263:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">workstations_report</span>(<span class="ruby-identifier">page</span>, <span class="ruby-identifier">elements</span>)
264:     <span class="ruby-identifier">row</span> = <span class="ruby-value">1</span>
265:      <span class="ruby-keyword kw">for</span> <span class="ruby-identifier">object</span> <span class="ruby-keyword kw">in</span> <span class="ruby-identifier">elements</span>
266:        <span class="ruby-ivar">@computer</span> = <span class="ruby-constant">Computer</span>.<span class="ruby-identifier">find</span>(<span class="ruby-identifier">object</span>.<span class="ruby-identifier">computer_id</span>)
267:        <span class="ruby-ivar">@screen</span> = <span class="ruby-constant">Screen</span>.<span class="ruby-identifier">find</span>(<span class="ruby-identifier">object</span>.<span class="ruby-identifier">screen_id</span>)
268:        <span class="ruby-ivar">@printer</span> = <span class="ruby-constant">Printer</span>.<span class="ruby-identifier">find</span>(<span class="ruby-identifier">object</span>.<span class="ruby-identifier">printer_id</span>) <span class="ruby-keyword kw">rescue</span> <span class="ruby-keyword kw">nil</span>
269:        <span class="ruby-ivar">@place</span> = <span class="ruby-constant">Place</span>.<span class="ruby-identifier">find</span>(<span class="ruby-identifier">object</span>.<span class="ruby-identifier">place_id</span>)
270: 
271:        <span class="ruby-identifier">page</span>.<span class="ruby-identifier">write</span>(<span class="ruby-identifier">row</span>,<span class="ruby-value">0</span>,<span class="ruby-ivar">@computer</span>.<span class="ruby-identifier">name</span>)
272:        <span class="ruby-identifier">page</span>.<span class="ruby-identifier">write</span>(<span class="ruby-identifier">row</span>,<span class="ruby-value">1</span>,<span class="ruby-ivar">@computer</span>.<span class="ruby-identifier">ip</span>)
273:        <span class="ruby-identifier">page</span>.<span class="ruby-identifier">write</span>(<span class="ruby-identifier">row</span>,<span class="ruby-value">2</span>,<span class="ruby-ivar">@computer</span>.<span class="ruby-identifier">mac</span>)
274:        <span class="ruby-identifier">page</span>.<span class="ruby-identifier">write</span>(<span class="ruby-identifier">row</span>,<span class="ruby-value">3</span>,<span class="ruby-ivar">@screen</span>.<span class="ruby-identifier">description_model</span>)
275:        <span class="ruby-identifier">page</span>.<span class="ruby-identifier">write</span>(<span class="ruby-identifier">row</span>,<span class="ruby-value">4</span>,<span class="ruby-ivar">@screen</span>.<span class="ruby-identifier">serialnumber</span>)
276:        <span class="ruby-identifier">page</span>.<span class="ruby-identifier">write</span>(<span class="ruby-identifier">row</span>,<span class="ruby-value">5</span>,<span class="ruby-ivar">@printer</span>.<span class="ruby-identifier">description_model</span>) <span class="ruby-keyword kw">rescue</span> <span class="ruby-keyword kw">nil</span>
277:        <span class="ruby-identifier">page</span>.<span class="ruby-identifier">write</span>(<span class="ruby-identifier">row</span>,<span class="ruby-value">6</span>,<span class="ruby-ivar">@printer</span>.<span class="ruby-identifier">serialnumber</span>) <span class="ruby-keyword kw">rescue</span> <span class="ruby-keyword kw">nil</span>
278:        <span class="ruby-identifier">page</span>.<span class="ruby-identifier">write</span>(<span class="ruby-identifier">row</span>,<span class="ruby-value">7</span>,<span class="ruby-ivar">@place</span>.<span class="ruby-identifier">title</span>)
279:        <span class="ruby-identifier">row</span> <span class="ruby-operator">+=</span> <span class="ruby-value">1</span>
280:      <span class="ruby-keyword kw">end</span>
281:   <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000195" class="method-detail">
        <a name="M000195"></a>

        <div class="method-heading">
          <a href="#M000195" class="method-signature">
          <span class="method-name">xls_report</span><span class="method-args">(path, worksheet, model, elements, heads, method, param_id)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
This method generate a xls file to download
</p>
<p>
Parameters:
</p>
<pre>
 path: way where the xls file will be save in the server application
 worksheet: name of worksheet
 model: model of data to get
 elements: name that will be provide to the array when we get records
 heads: the names of first row in the xls file
 method: is the name of method to implement in the rescue of records
 param_id: parameter to provide the place from we need get records
</pre>
<p>
Return a .xls file with the report
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000195-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000195-source">
<pre>
     <span class="ruby-comment cmt"># File lib/report_system.rb, line 105</span>
105:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">xls_report</span>(<span class="ruby-identifier">path</span>, <span class="ruby-identifier">worksheet</span>, <span class="ruby-identifier">model</span>, <span class="ruby-identifier">elements</span>, <span class="ruby-identifier">heads</span>, <span class="ruby-identifier">method</span>, <span class="ruby-identifier">param_id</span>)
106:     <span class="ruby-identifier">eval</span> <span class="ruby-node">%&quot;
107: 
108:      workbook = Excel.new('#{RAILS_ROOT}#{path}')
109:      page = workbook.add_worksheet('#{worksheet}')
110: 
111:      get_heads(page, heads)
112:      get_elements(elements, model, method, param_id)
113:      make_a_report_of(elements, page, @#{elements})
114: 
115:      workbook.close
116:      send_file '#{RAILS_ROOT}#{path}'
117: 
118:     &quot;</span>;
119:   <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000194" class="method-detail">
        <a name="M000194"></a>

        <div class="method-heading">
          <a href="#M000194" class="method-signature">
          <span class="method-name">xls_report_complete_for_a_place</span><span class="method-args">(path,method, param_id, heads)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
This method generate a xls file to download with a complete list of
hardware for a specific place
</p>
<p>
Parameters:
</p>
<pre>
 path: way where the xls file will be save in the server application
 worksheet: name of worksheet
 heads: the names of first row in the xls file
 method: is the name of method to implement in the rescue of records
 param_id: parameter to provide the place from we need get records
</pre>
<p>
Return a .xls file with the report
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000194-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000194-source">
<pre>
    <span class="ruby-comment cmt"># File lib/report_system.rb, line 62</span>
62:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">xls_report_complete_for_a_place</span>(<span class="ruby-identifier">path</span>,<span class="ruby-identifier">method</span>, <span class="ruby-identifier">param_id</span>, <span class="ruby-identifier">heads</span>)
63:     <span class="ruby-identifier">eval</span> <span class="ruby-node">%&quot;
64: 
65:     workbook = Excel.new('#{RAILS_ROOT}#{path}')
66: 
67:     get_elements('computers', 'Computer', method, param_id)
68:     get_elements('screens', 'Screen', method, param_id)
69:     get_elements('printers', 'Printer', method, param_id)
70:     get_elements('workstations', 'Workstation', method, '(' + param_id + ')')
71: 
72:     row = 1
73:     page = workbook.add_worksheet(t('places.computer'))
74:     get_heads(page, heads)
75:     computers_report(page, @computers, row)
76: 
77:     page = workbook.add_worksheet(t('places.screen'))
78:     generic_report(page, @screens, row, false)
79: 
80:     page = workbook.add_worksheet(t('places.printer'))
81:     generic_report(page, @printers, row, false)
82: 
83:     page = workbook.add_worksheet('places.workstations')
84:     workstations_report(page, @workstations)
85: 
86:     workbook.close
87:     send_file '#{RAILS_ROOT}#{path}'
88: 
89:     &quot;</span>;
90:   <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000193" class="method-detail">
        <a name="M000193"></a>

        <div class="method-heading">
          <a href="#M000193" class="method-signature">
          <span class="method-name">xls_report_workstations</span><span class="method-args">(path,method, param_id, heads)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
This method generate a xls file to download with a complete list of
workstations
</p>
<p>
Parameters:
</p>
<pre>
 path: way where the xls file will be save in the server application
 worksheet: name of worksheet
 heads: the names of first row in the xls file
 method: is the name of method to implement in the rescue of records
 param_id: parameter to provide the place from we need get records
</pre>
<p>
Return a .xls file with the report
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000193-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000193-source">
<pre>
    <span class="ruby-comment cmt"># File lib/report_system.rb, line 32</span>
32:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">xls_report_workstations</span>(<span class="ruby-identifier">path</span>,<span class="ruby-identifier">method</span>, <span class="ruby-identifier">param_id</span>, <span class="ruby-identifier">heads</span>)
33: 
34:     <span class="ruby-ivar">@worksheet</span> = <span class="ruby-identifier">t</span>(<span class="ruby-value str">'workstations.list_of_equipments'</span>)
35:     <span class="ruby-identifier">eval</span> <span class="ruby-node">%&quot;
36: 
37:     workbook = Excel.new('#{RAILS_ROOT}#{path}')
38: 
39:     get_elements('workstations', 'Workstation', method, '(' + param_id + ')')
40:     page = workbook.add_worksheet(@worksheet)
41:     get_heads(page, heads)
42:     workstations_report(page, @workstations)
43: 
44:     workbook.close
45:     send_file '#{RAILS_ROOT}#{path}'
46: 
47:     &quot;</span>;
48:   <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>


    </div>


  </div>


<div id="validator-badges">
  <p><small><a href="http://validator.w3.org/check/referer">[Validate]</a></small></p>
</div>

</body>
</html>